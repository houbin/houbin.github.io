
title: gdb调试缺失源码问题
date: 2016-02-23 10:39:33
tags: gdb
---

## 起源

之前使用gdb调试时，都是通过源码编译之后，直接使用可执行文件直接进行编译。生产环境和内网测试环境的程序虽然也是加了-g编译，但是都是直接查看日志，从来没有通过gdb调试过。
今天发现了一个问题，从日志上不太确定问题的原因，就想着直接在内网的测试环境上通过gdb调试，之前一直以为加上-g之后可执行文件就加上了包含源码的调试信息，就通过gdb -p [进程号]开始调试内网测试程序，但是发现找到对应的源码文件。

<!-- more -->

## 验证
在本地创建了一个最简单的main.cc文件

``` c++
int main()
{
    return 0;
}
```

[root@ross houbin]# g++ -c main.cc -o main.o -g
[root@ross houbin]# objdump -s main.o | less

```
Contents of section .debug_str:
 0000 474e5520 432b2b20 342e342e 37203230  GNU C++ 4.4.7 20
 0010 31323033 31332028 52656420 48617420  120313 (Red Hat 
 0020 342e342e 372d3136 29006d61 696e006d  4.4.7-16).main.m
 0030 61696e2e 6363002f 746d702f 686f7562  ain.cc./tmp/houb
 0040 696e00                               in.
```
可以看到/tmp/houbin和main.cc字样

## 结论
通过上面最简单文件的验证可知，编译之后的文件不会保存所有的源码文件，只是保存了一个索引(源码文件所在的绝对路径和文件名称)，这样再使用gdb调试的时候，就需要把对应的源码目录保存在调试编译时的绝对路径就可以了。
